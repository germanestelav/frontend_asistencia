import{c as n,f as b,a as e,w as x,b as s,v as r,z as V,t as c,d as f,h as w,r as v,i as U,u as j,o as i,j as S}from"./index-Jc6aNIQy.js";import{a as T}from"./adminService-oFDKTrp6.js";import{_ as g}from"./Navbar-BmhPClkr.js";import"./authStore-BuOsiNc2.js";const A={class:"container mt-4"},M={class:"row"},N={class:"col-md-8 mx-auto"},k={class:"card"},q={class:"card-body p-4"},D={class:"row mb-3"},C={class:"col-md-6"},H={class:"col-md-6"},R={class:"row mb-3"},B={class:"col-md-6"},E={class:"col-md-6"},O={class:"row mb-3"},G={class:"col-md-6"},I={class:"col-md-6"},J={class:"row mb-3"},Y={class:"col-md-6"},z={class:"col-md-6"},P={class:"row mb-3"},$={class:"col-md-6"},h={class:"col-md-6"},F={key:0,class:"alert alert-danger"},K={key:1,class:"alert alert-success"},L={class:"d-flex gap-2"},Q=["disabled"],W={key:0},X={key:1},so={__name:"CrearTrabajador",setup(Z){const _=j(),l=v({nombre:"",apellido_paterno:"",apellido_materno:"",dni:"",telefono:"",usuario:"",contrasena:"",rol:"TRABAJADOR",hora_entrada:"",hora_salida:""}),u=v(!1),d=v(""),m=v(""),y=async()=>{var p,o;u.value=!0,d.value="",m.value="";try{const t={...l.value};t.hora_entrada&&(t.hora_entrada+=":00"),t.hora_salida&&(t.hora_salida+=":00"),await T.crearTrabajador(t),m.value="Trabajador creado exitosamente",setTimeout(()=>{_.push("/admin/trabajadores")},1500)}catch(t){const a=((o=(p=t.response)==null?void 0:p.data)==null?void 0:o.detail)||"Error al crear trabajador";a.includes("Ya existe un usuario con ese DNI")||a.includes("Ya existe un usuario con ese nombre de usuario")?d.value=a+". Si el trabajador ya existe pero está inactivo, puedes reactivarlo desde la lista de trabajadores.":d.value=a}finally{u.value=!1}};return(p,o)=>{const t=U("router-link");return i(),n("div",null,[b(g),e("div",A,[e("div",M,[e("div",N,[e("div",k,[e("div",q,[o[22]||(o[22]=e("h3",{class:"mb-4"},"Agregar Nuevo Trabajador",-1)),e("form",{onSubmit:x(y,["prevent"])},[e("div",D,[e("div",C,[o[10]||(o[10]=e("label",{class:"form-label"},"Nombre *",-1)),s(e("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>l.value.nombre=a),type:"text",class:"form-control",required:""},null,512),[[r,l.value.nombre]])]),e("div",H,[o[11]||(o[11]=e("label",{class:"form-label"},"Apellido Paterno *",-1)),s(e("input",{"onUpdate:modelValue":o[1]||(o[1]=a=>l.value.apellido_paterno=a),type:"text",class:"form-control",required:""},null,512),[[r,l.value.apellido_paterno]])])]),e("div",R,[e("div",B,[o[12]||(o[12]=e("label",{class:"form-label"},"Apellido Materno *",-1)),s(e("input",{"onUpdate:modelValue":o[2]||(o[2]=a=>l.value.apellido_materno=a),type:"text",class:"form-control",required:""},null,512),[[r,l.value.apellido_materno]])]),e("div",E,[o[13]||(o[13]=e("label",{class:"form-label"},"DNI * (8 dígitos)",-1)),s(e("input",{"onUpdate:modelValue":o[3]||(o[3]=a=>l.value.dni=a),type:"text",class:"form-control",pattern:"[0-9]{8}",maxlength:"8",required:""},null,512),[[r,l.value.dni]])])]),e("div",O,[e("div",G,[o[14]||(o[14]=e("label",{class:"form-label"},"Teléfono *",-1)),s(e("input",{"onUpdate:modelValue":o[4]||(o[4]=a=>l.value.telefono=a),type:"text",class:"form-control",required:""},null,512),[[r,l.value.telefono]])]),e("div",I,[o[15]||(o[15]=e("label",{class:"form-label"},"Usuario * (nombre de usuario)",-1)),s(e("input",{"onUpdate:modelValue":o[5]||(o[5]=a=>l.value.usuario=a),type:"text",class:"form-control",required:""},null,512),[[r,l.value.usuario]])])]),e("div",J,[e("div",Y,[o[16]||(o[16]=e("label",{class:"form-label"},"Contraseña *",-1)),s(e("input",{"onUpdate:modelValue":o[6]||(o[6]=a=>l.value.contrasena=a),type:"password",class:"form-control",required:""},null,512),[[r,l.value.contrasena]])]),e("div",z,[o[18]||(o[18]=e("label",{class:"form-label"},"Rol *",-1)),s(e("select",{"onUpdate:modelValue":o[7]||(o[7]=a=>l.value.rol=a),class:"form-select",required:""},[...o[17]||(o[17]=[e("option",{value:"TRABAJADOR"},"Trabajador",-1),e("option",{value:"DUENO"},"Dueño",-1)])],512),[[V,l.value.rol]])])]),e("div",P,[e("div",$,[o[19]||(o[19]=e("label",{class:"form-label"},"Hora Entrada (HH:MM:SS)",-1)),s(e("input",{"onUpdate:modelValue":o[8]||(o[8]=a=>l.value.hora_entrada=a),type:"time",step:"1",class:"form-control"},null,512),[[r,l.value.hora_entrada]])]),e("div",h,[o[20]||(o[20]=e("label",{class:"form-label"},"Hora Salida (HH:MM:SS)",-1)),s(e("input",{"onUpdate:modelValue":o[9]||(o[9]=a=>l.value.hora_salida=a),type:"time",step:"1",class:"form-control"},null,512),[[r,l.value.hora_salida]])])]),d.value?(i(),n("div",F,c(d.value),1)):f("",!0),m.value?(i(),n("div",K,c(m.value),1)):f("",!0),e("div",L,[e("button",{type:"submit",class:"btn btn-primary",disabled:u.value},[u.value?(i(),n("span",W,"Guardando...")):(i(),n("span",X,"Guardar"))],8,Q),b(t,{to:"/admin/trabajadores",class:"btn btn-secondary"},{default:w(()=>[...o[21]||(o[21]=[S(" Cancelar ",-1)])]),_:1})])],32)])])])])])])}}};export{so as default};
